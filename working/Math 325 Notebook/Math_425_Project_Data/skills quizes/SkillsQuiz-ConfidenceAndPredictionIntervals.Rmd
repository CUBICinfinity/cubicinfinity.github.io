---
title: "Skills Quiz: Confidence and Prediction Intervals"
output: 
  html_document:
    theme: cerulean
    code_folding: hide
    toc: true
    toc_float: true
---


## Instructions

Use this file to keep a record of your work as you complete the "Skills Quiz: Confidence and Prediction Intervals" assignment in Canvas.


----

<!-- Note: The {} after each Problem and Part header allows you to keep track of what work you have completed. Write something like {Done} once you complete each problem and your html file will then show you a nice summary of what you have "done" already. -->


## Problem 1 {}

Install the `alr3` library in R: `install.packages("alr3")`.

From `library(alr3)` open the `BGSall` data set in R.  As stated in the help file for this data set, this data is a collection of measurements on "children born in 1928-29 in Berkeley, CA."

`> ?BGSall`

`> View(BGSall)`

A standing tradition is that if you measure a child when they are 2-years old, and double their height, this will give a good prediction on their final adult height. Let's see if this is true. 

Perform a regression that could predict a child's 18-year old height from their 2-year old height.

### Part (a) {}

Type out the mathematical equation for this regression model and label both $Y$ and $X$ in the equation.

<div class="YourAnswer">

$$
  \underbrace{Y_i}_\text{Height 18} = \beta_0 + \beta_1 \underbrace{X_i}_\text{Height 2} + \epsilon_i \quad \text{where } \epsilon_i \sim N(0, \sigma^2)
$$

</div>


### Part (b) {}
 
Plot a scatterplot of the data with your regression line overlaid. Write out the fitted regression equation.

<div class="YourAnswer">

```{r}
bgs_lm <- lm(HT18 ~ HT2, data = BGSall)
plot(HT18 ~ HT2, data = BGSall, col = "#c0b090", pch = 16)
abline(bgs_lm, lwd = 2, col = "Gray60")

bgs_lm
```

$$
  \hat{Y}_i = 45.797 + 1.444 X_i
$$

</div>


### Part (c) {}

Report the test statistics and p-values for the following hypotheses. (The hypotheses about $\beta_0$ claim that at age 0-years, a child should have height 0 cm. The hypotheses about $\beta_1$ claim that height doubles from age 2 to 18.)

$$ 
  \begin{array}{l}
    H_0: \beta_0 = 0 \\
    H_a: \beta_0 \neq 0 \\
  \end{array} \quad 
  \begin{array}{l}
    H_0: \beta_1 = 2 \\
    H_a: \beta_1 \neq 2 \\
  \end{array}
$$

<div class="YourAnswer">

```{r}
summary(bgs_lm)

#Slope:
(1.4441 - 2) / 0.1901 # = -2.92425

pt(-2.92425, df = 134) * 2 # remember that this is two-tailed
```
Intercept:
t-value = 2.742, P-value = 0.00694


</div> 
 
 
### Part (d) {}


State the slope, y-intercept, and $R^2$ of this regression. Further, provide 95% confidence intervals for the slope and intercept. Interpret the values.

<div class="YourAnswer">

```{r}
confint(bgs_lm)
t_stat <- qt(1 - 0.05/2, 134) # I think this has fewer rounding errors
# But this is what's going on:
45.7966 + c(-1,1) * t_stat * 16.7006
1.4441 + c(-1,1) * t_stat * 0.1901


```

Type your answer here...

</div>


### Part (e) {}

Create a residuals vs fitted-values plot and Q-Q Plot of the residuals for this regression. What do these plots show?

<div class="YourAnswer">

```{r}
plot(bgs_lm, which = 1)
qqPlot(bgs_lm)
plot(bgs_lm$residuals)
```

</div>



### Part (f) {}

A certain stats teacher at BYU-Idaho has a son named Andrew who turns 2-years old in a couple of weeks. He is currently 2 feet 9 inches tall. Predict his 18-year old height in centimeters with 95% confidence.

<div class="YourAnswer">

```{r}
predict(bgs_lm, data.frame(HT2 = 83.82), interval = "prediction")
```

</div>


----

## Problem 2 {}

Open the `wblake` data set from library(alr3).

`> ?wblake`

`> View(wblake)`

If you love fishing, then you might like this data. The goal of this data was to see if there was a link in the radius size of a key "Scale" of a fish and the overall "Length" of the fish.

### Part (a) {}

Type out the mathematical equation for this regression model and label both $Y$ and $X$ in the equation.

<div class="YourAnswer">

$$
  \underbrace{Y_i}_\text{Scale} = \beta_0  + \beta_1\underbrace{X_i}_\text{Length} + \epsilon_i \quad \text{where} \epsilon_i \sim N(0,\sigma^2)
$$

</div>


### Part (b) {}
 
Plot a scatterplot of the data with your regression line overlaid. Write out the fitted regression equation. State the $R^2$ value of the regression.

<div class="YourAnswer">

```{r}
plot(Scale ~ Length, data = wblake, pch = 16, col = rgb(.2,.2,.2,.2))
wb_lm <- lm(Scale ~ Length, data = wblake)
abline(wb_lm)
summary(wb_lm)
```

$$
  \hat{Y}_i = -1.4308 + 0.0378 X_i
$$

</div>


### Part (c) {}

Diagnose the regression with a residuals vs. fitted-values plot. Determine which Y-transformation is suggested for this data.

<div class="YourAnswer">

```{r}
plot(wb_lm, which = 1)
qqPlot(wb_lm)
plot(wb_lm$re)

boxCox(wb_lm)
```

Type your answer here...

</div> 
 
 
### Part (d) {}

Perform a regression of the form $Y' = Y^\lambda$. Use your answer to Part (c) to select $\lambda$.

Plot the regression in the transformed space, $Y' \sim X$ and add the fitted regression to the plot. 

<div class="YourAnswer">

```{r}
t_wb_lm <- lm(Scale^0.5 ~ Length, data = wblake)
plot(Scale^0.5 ~ Length, data = wblake, pch = 16, col = rgb(0.2,0.2,0.2,0.2), main = "title", sub = "test")
abline(t_wb_lm)
```

Type your answer here...

</div>  
 
### Part (e) {}

State the slope, y-intercept, and $R^2$ of this transformed regression. 

<div class="YourAnswer">

```{r}
summary(t_wb_lm)
```

Type your answer here...

</div>


### Part (f) {}

Create a residuals vs fitted-values plot and Q-Q Plot of the residuals for this trasnformed regression. Does this regression look better than the original?

<div class="YourAnswer">

```{r}
plot(t_wb_lm, which = 1)
plot(wb_lm, which = 1)
qqPlot(t_wb_lm)
qqPlot(wb_lm)
```

</div>
 

### Part (g) {}

Untransform the fitted regression equation and draw it on a scatterplot of the original data. Include the original regression line on this plot. 

<div class="YourAnswer">

```{r}
plot(Scale ~ Length, data = wblake, col = rgb(0.2,0.2,0.2,0.2), pch = 16)
curve((t_wb_lm$coef[1] + t_wb_lm$coef[2] * x)^2, add = T, col = "skyblue")
abline(wb_lm)
```

</div>



### Part (h) {}

Place two prediction intervals for the Scale radius when the Length of the fish is 250 on your scatterplot of the data in the original units.

1. Show the prediction interval from the original regression in the original units. 

2. Show the prediction interval from the transformed regression back on the original units.

<div class="YourAnswer">

```{r}
interval <- predict(wb_lm, data.frame(Length = 250), interval = "predict")
transformed_int <- predict(t_wb_lm, data.frame(Length = 250), interval = "predict")^2

plot(Scale ~ Length, data = wblake, col = rgb(0.2,0.2,0.2,0.2), pch = 16)
abline(wb_lm, lwd = 2, col = "gray70")
curve((t_wb_lm$coef[1] + t_wb_lm$coef[2] * x)^2, add = T, col = "skyblue", lwd = 2)
abline(v = 250, col = "gray70", h = interval, lty = 2)
abline(h = transformed_int, col = "skyblue", lty = 4)

interval
transformed_int
```

</div>


----







<style>

.YourAnswer {
  color: #317eac;
  padding: 10px;
  border-style: solid;
  border-width: 2px;
  border-color: skyblue4;
  border-radius: 5px;
}

</style>

 
 