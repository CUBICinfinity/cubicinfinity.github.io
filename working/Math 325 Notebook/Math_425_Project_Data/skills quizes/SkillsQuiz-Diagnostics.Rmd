---
title: "Skills Quiz: Regression Diagnostics"
output: 
  html_document:
    theme: cerulean
    code_folding: hide
    toc: true
    toc_float: true
---


## Instructions

Use this file to keep a record of your work as you complete the "Skills Quiz: Regression Diagnostics" assignment in Canvas.


----

<!-- Note: The {} after each Problem and Part header allows you to keep track of what work you have completed. Write something like {Done} once you complete each problem and your html file will then show you a nice summary of what you have "done" already. -->

## Problem 1 {}

Open the `Davis` dataset in R, found in `library(car)`. As stated in the help file for this data set, "The subjects were men and women engaged in regular exercise." 

Perform a simple linear regression of the height of the individual based on their weight.

### Part (a) {}

Type out the mathematical equation for this regression model and label both $Y$ and $X$ in the equation.

<div class="YourAnswer">

$$
  \underbrace{Y_i}_\text{height} = \beta_0 + \beta_1 \underbrace{X_i}_\text{weight} + \epsilon_i \quad \text{where} \ \epsilon_i \sim N(0, \sigma^2)
$$
Estimated: Beta0 = 160.0931, Beta1 = 0.1509

</div>


### Part (b) {}
 
Plot a scatterplot of the data with your regression line overlaid.

<div class="YourAnswer">

```{r}
library(car)
davislm <- lm(height ~ weight, data = Davis)
plot(height ~ weight, data = Davis)
abline(davislm$coefficients[1], davislm$coefficients[2])
```

</div>


### Part (c) {}

Create a residuals vs fitted-values plot for this regression. What does this plot show?

<div class="YourAnswer">

```{r}
plot(davislm, which = 1:2)
plot(davislm$residuals ~ seq_len(length(davislm$residuals)))
```

Row 12 has the height and weight switched, which is messing up the model. Other than that it looks good, but I will be sure once I fix it.

</div> 
 
 
### Part (d) {}

State and interpret the slope, y-intercept, and $R^2$ of this regression. Are they meaningful for this data under the current regression?

<div class="YourAnswer">

```{r}
summary(davislm)
```

Intercept: 160.09312, Slope: 0.15086, R-squared: 0.0311. They would be meaningful if they were correct. The R-squared value is really low, but they aren't meaningful because of the outlier.

</div>


### Part (e) {}

Run `View(Davis)` in your Console. What do you notice about observation #12 in this data set? 

Perform a second regression for this data with observation #12 removed. Recreate the scatterplot of Part (b) with two regression lines showing this time. The first regression line should include the outlier. The second should exclude the outlier. Include a legend to show which line is which.

<div class="YourAnswer">

```{r}
# Oh so we're just removing it. That makes it easier. I guess this isn't the data wrangling class.
Davis_fixed <- Davis[-12,]
davislm2 <- lm(height ~ weight, data = Davis_fixed)
plot(height ~ weight, data = Davis)
abline(davislm$coefficients[1], davislm$coefficients[2], lwd = 2)
abline(davislm2$coefficients[1], davislm2$coefficients[2], col = "#F02030", lwd = 2)
legend(105, 160, legend = c(("Original Line"), ("New Line")), lty = 1, lwd = 2, cex = 0.8, bty = "n", col = c("black", "#F02030"))
```

</div>


### Part (f) {}

Compute the slope, y-intercept, and $R^2$ value for the regression with the outlier removed. compare the results to the values when the outlier was present.

<div class="YourAnswer">

```{r}
summary(davislm2)
```

Intercept: 136.8366, Slope: 0.5168936, R-Squared: 0.592
All the values are greater, except the intercept.

</div>


### Part (g)

Create a residuals vs fitted-values plot for the regression with the outlier removed. How do things look now?

<div class="YourAnswer">

```{r}
plot(davislm2, which = 1:2)
plot(davislm2$residuals ~ seq_len(length(davislm2$residuals)))
```

It's significantly better. There are some outliers in the data, but they don't seem too far out there. I would accept the model.

</div>


----

## Problem 2 {}

Open the **Prestige** data set found in `library(car)`.

Perform a regression that explains the 1971 average annual **income** from jobs according to their "Pineo-Porter **prestige** score for occupation, from a social survey conducted in the mod-1960's."

### Part (a) {}

Plot the data and fitted simple linear regression line.

<div class="YourAnswer">

```{r}
?Prestige
plot(income ~ prestige, data = Prestige)
P <- lm(income ~ prestige, data = Prestige)
abline(P)
```

</div>


### Part (b) {}

State the estimated values for $\beta_0$, $\beta_1$, and $\sigma$ for this regression. 

<div class="YourAnswer">

```{r}
summary(P)
```

</div>


### Part (c) {}

Create a residuals vs fitted-values plot and a Q-Q Plot of the residuals for this regression. 

<div class="YourAnswer">

```{r}
plot(P, which = 1:2)
```

</div> 


### Part (d) {}

Comment on any difficulties the diagnostic plots in Part (c) reveal about the regression. 

Comment on which estimates of Part (b) are likely effected by these difficulties.

<div class="YourAnswer">

Type your answer here...

</div> 
 

 



----


## Problem 3 {}

Open the **Burt** data set from library(car).

This data set is famous for being fraudulent, or fake. See ?Burt for more details. One of the first indicators that it was fraudulent was revealed by regressing IQbio ~ IQfoster. This regression was just a little too good to be real. (Note that for social science data, like this data, $R^2$ values above 0.3 are impressive. Values above 0.7 are rare.)

### Part (a) {}

Plot the data and fitted regression line. State the estimated values of $\beta_0$, $\beta_1$, and $\sigma$ as well as the $R^2$ of the regression.

<div class="YourAnswer">

```{r}
?Burt
B <- lm(IQbio ~ IQfoster, data = Burt)
plot(IQbio ~ IQfoster, data = Burt)
abline(B)
summary(B)
```

</div>



### Part (b) {}

Create a (1) residuals vs. fitted-values plot, (2) Q-Q Plot of the residuals, and (3) residuals vs. order plot for this regression. Are any problems with regression assumption violations visible in these plots?

<div class="YourAnswer">

```{r}
plot(B, which = 1)
qqPlot(B)
plot(B$res)
```

</div>


### Part (c) {}

Comment on what the three diagnostic plots of Part (b) show for the regression. 

<div class="YourAnswer">

Type your answer here...

</div>





----

## Problem 4

Open the **mtcars** data set in R.

Perform a regression of **mpg** explained by the **disp**lacement of the vehicle's engine.

### Part (a) {}

Plot the data and fitted regression line. State the estimated values of $\beta_0$, $\beta_1$, and $\sigma$ as well as the $R^2$ of the regression.

<div class="YourAnswer">

```{r}
carslm <- lm(mpg ~ disp, data = mtcars)
plot(mpg ~ disp, data = mtcars)
abline(carslm)
summary(carslm)
```

</div>



### Part (b) {}

Create a (1) residuals vs. fitted-values plot, (2) Q-Q Plot of the residuals, and (3) residuals vs. order plot for this regression. Are any problems with regression assumption violations visible in these plots?

<div class="YourAnswer">

```{r}
plot(carslm, which = 1)
qqPlot(carslm)
plot(carslm$residuals)
```

</div>


### Part (c) {}

Comment on what the three diagnostic plots of Part (b) show for the validity of the values computed in Part (a). 

<div class="YourAnswer">

The data is not linear. I can tell from the residuals vs fitted and from the original plot. The variance also is not consistent which is probably part of the trend not being linear. The normality of the residualr isn't too bad considering the other issues. I think after fixing the model they would look better. The residuals vs order doesn't show any patterns, which is good.

</div>








<style>

.YourAnswer {
  color: #317eac;
  padding: 10px;
  border-style: solid;
  border-width: 2px;
  border-color: skyblue4;
  border-radius: 5px;
}

</style>

 
 