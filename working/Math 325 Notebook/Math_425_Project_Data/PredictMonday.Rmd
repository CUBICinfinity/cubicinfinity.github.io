---
title: "Predicting Monday"
author: "Jim Greene"
date: "January 12, 2019"
output: 
  html_document:
    code_folding : hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(mosaic)
library(car)
library(pander)
```

## The Assignment

Using only simple linear regression and 10 to 30 data points from the weather data on [byui.edu](http://web.byui.edu/Weather/Data/2017/1) predict what the high tempurature will be on Monday, January 14th, 2019.

## First attempt

```{r}
highTemp <- c(9,26,34,35,36,26,0,28,37,19,17,39)

annualMonday <- c("January 15th, 2007", "January 14th, 2008", "January 12th, 2009", "January 11th, 2010", "January 17th, 2011", "January 16th, 2012", "January 14th, 2013", "January 16th, 2014", "January 12th, 2015", "January 11th, 2016", "January 16th, 2017", "January 15th, 2018")

yearlyTemps <- data.frame(annualMonday, highTemp)
```

I created this graph first for fun thinking that looking at the pattern would give me a clue about the temperature for 2019. This graph kind of cheats by using a 2018 temperature from Wunderground. Based on my intuition of the pattern I would expect the high tempurature for this year to be lower than last, but not too much lower: I guess 29 degrees F. The average value of these monday high temperatures is `r mean(yearlyTemps$highTemp)` degrees F.

```{r, fig.width = 8.5}
ggplot(data = yearlyTemps, aes(y = highTemp, x = factor(annualMonday, level = c("January 15th, 2007", "January 14th, 2008", "January 12th, 2009", "January 11th, 2010", "January 17th, 2011", "January 16th, 2012", "January 14th, 2013", "January 16th, 2014", "January 12th, 2015", "January 11th, 2016", "January 16th, 2017", "January 15th, 2018")))) +
  geom_point() +
  geom_line(aes(group = 1)) +
  geom_hline(aes(yintercept = mean(highTemp)), linetype = "dotted") +
  annotate("text", x = 3.7, y = 26, label = "Average High Temp", size = 2) +
  theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
  labs(x = "Annual Monday", y = "High Temperature")
```

## The Regression

The assignment asks for a simple linear regression, so I chose to use the high temperature of the preceeding Saturday as my explanatory variable.

$$
  \underbrace{\hat{Y}_i}_\text{Monday High} = \beta_0 + \beta_1 \underbrace{X_i}_\text{Saturday High} + \epsilon_i \quad \text{where} \ \epsilon_i \sim N(0,\sigma^2)
$$
$$
H_0: \beta_1 = 0
$$

$$
H_a: \beta_1 \ne 0
$$

```{r, fig.width = 8.5}
setwd("C:/Users/Jim/Desktop/MATH 325/Math 325 Notebook")
monday <- read.csv("Data/Monday14thTemp.csv")
mondayLM <- lm(MondayHigh ~ SaturdayHigh, data = monday)

plot(MondayHigh ~ SaturdayHigh, data = monday, main = "Relation between Saturday and Proceeding Monday High Temperatures for Each Year \nUsing the Monday Closest to the 14th of January", ylab = "High Tempurature on Proceeding Monday (F)", xlab = "High Tempurature on Saturday (F)", pch = 16, col = "gray50")
abline(mondayLM$coefficients[1], mondayLM$coefficients[2])
```

Linear model:
$$
  \underbrace{\hat{Y}_i}_\text{Monday High} = 6.898 + 0.694\underbrace{X_i}_\text{Saturday High} + \epsilon_i \quad \text{where} \ \epsilon_i \sim N(0,\sigma^2)
$$
According to this model, a one degree F increase in the Saturday high temperature results in a 0.69 degree increase in the average Monday high temperature. The Monday is colder on average than the Saturday. This model gives `r round(predict.lm(mondayLM, data.frame(SaturdayHigh = 28))[[1]], digits = 1)` F as the predicted tempurature for Monday.

## Details and Validation

```{r}
pander(summary(mondayLM))
```

The slope's p-value of 0.002 is significant (I would have accepted anything below 0.05), but were the other requiremets met?

```{r, fig.height = 3}

par(mfrow = c(1,3))
plot(mondayLM, which = 1)
qqPlot(mondayLM$residuals, main = "QQ-Plot", ylab = "Residuals")
plot(mondayLM$residuals ~ seq.default(from = 1999, to = 2017), xlab = "Year", main = "Order of Residuals", ylab = "Residuals")
```

No, because the relation doesn't appear to be linear. As for the other requirements, the variance looks okay given the sample I have, the residuals are normally distributed, and there aren't any patterns in the order of residuals.

<br />

The dataframe used: (The Monday closest to the 14th of January is what I selected. This may seem odd, but I thought that CO2 levels and other changes with the weekend could be important.)
```{r}
pander(monday)
```