---
title: "Laptop Prices"
author: "Jim Greene"
date: "January 19, 2019"
output:
  html_document:
    code_folding : "hide"
    theme: "united"
---

## The Regression

I will create a simple linear regression for the price of laptops using a single quantitative explanatory variable.

```{r setup, include=FALSE}
library(tidyverse)
library(car)
setwd("C:/Users/Jim/Desktop/MATH 325/Math 325 Notebook/Math 425")

# I like calling it "drive type" and "disk space" better than "memory", because "memory" can be confusing.
laptops <- read_csv("data/laptops.csv") %>%
  separate(Memory, c("DiskSpace", "DriveType"), extra = "merge") %>%
  separate(DiskSpace, c("DiskSpace","DiskSpaceUnits"), sep = "(?<=[0-9])(?=[A-Za-z])") %>%
  mutate(DiskSpace = as.numeric(DiskSpace)) %>%
  mutate(DiskSpaceGB = ifelse(DiskSpaceUnits == "TB", DiskSpace*1000, DiskSpace)) %>%
  separate(Ram, c("RamSize","RamUnits"), sep = "(?<=[0-9])(?=[A-Za-z])") %>%
  mutate(RamSize = as.numeric(RamSize)) %>% 
  mutate(CpuGHz = as.numeric(str_extract(Cpu, "[0-9.]*?(?=GHz)"))) %>% 
  mutate(Price_USD = Price_euros * 1.14)
```

I checked a few relations, but the CPU speed had one of the higher correlations, so I chose to stick with it. RAM size had a much higher correlation, but it's nearly categorical with how few values there are.

Here is my plot:

```{r}
ghzlm <- lm(Price_USD ~ CpuGHz, data = laptops)
laptops %>% 
  ggplot(aes(x = CpuGHz, y = Price_USD)) +
  annotate("point", x = 2.9, y = 355.98, size = 3, color = "#F08008", alpha = 0.9) +
  geom_point(color = "#10A070", alpha = 0.5) +
  geom_abline(slope = ghzlm$coefficients[2], intercept = ghzlm$coefficients[1], color = "#666666") +
  labs(title = "A Linear Regression of Laptop Prices Using the Processor Speed", x = "CPU Speed, GHz", y = "Price, USD") +
  annotate("text", x = 3.2, y = 225, label = "My laptop, $355.98", size = 3) +
  theme_bw() +
  scale_y_continuous(labels = scales::dollar, breaks = seq(0, 7000, 500)) +
  scale_x_continuous(breaks = seq(0.8, max(laptops$CpuGHz), 0.2))
```

Just based on this plot, I got a relatively good deal on my own laptop.

$$
  \underbrace{\hat{Y}_i}_\text{Price} = \overbrace{-275.70}^\text{Intercept} + \overbrace{677.19}^\text{Slope} \underbrace{X_i}_\text{CPU GHz} + \overbrace{\epsilon_i}^\text{Individual Error} \quad \text{where} \ \epsilon_i \sim N(0,\sigma^2)
$$
In this case, the null hypothesis would be that the slope ($\beta_1$) of the regression is zero. I assumed that price would have a positive correlation with processor speed and as we see, that is the case.

$$
H_0: \beta_1 = 0
$$
$$
H_a: \beta_1 \ne 0
$$

The model shows a slope of 677.19, that is, an increase in 1GHz of speed in a CPU results in a $677.19 increase in the average price for the laptop. The p-value is significant (less than 2e-16), which would be cause to reject the null hypothesis, but just by looking at the graph it is obvious to me that the relationship is more complex. I have some comments to make about the validity of this regression in the next section.

The intercept wasn't of interest to me because there aren't (real) computers on the market that don't complete any processes. However, it is nice to confirm that it's p-value was also significant (0.003).

## Details and Validation

```{r}
summary(ghzlm)
```

The R-squared value is 0.1845, which means the correlation value, r, is the square root of that, `r round(sqrt(0.1845), 4)`.
So 18.45% of the variation in laptop prices can be explained by the CPU speed.
I would like to note that not all CPUs of the same speed are equal performers ([Click here for more info](https://www.howtogeek.com/177790/why-you-cant-use-cpu-clock-speed-to-compare-computer-performance/)). Anyone who shops for a laptop would benefit from looking up the benchmarks of the laptop they are getting, including those of its individual components (Try [passmark.com](http://passmark.com)). But it is true that the advertized CPU speed has a significant effect on the price of the laptop.

```{r, fig.height = 3}
par(mfrow = c(1,3))
plot(ghzlm, which = 1)
qqPlot(ghzlm, col.lines = "red", main = "QQ-Plot")
plot(ghzlm$residuals ~ seq_len(length(ghzlm$residuals)), main = "Ordered Residuals", ylab = "Residuals", xlab = "Order of Appearance in Dataset")
```

As I suggested above and can be seen from the three plots; the linearity is off, variance is variable, and the residuals are nowhere near normally distributed (making pretty much all of my equation a lie). There aren't any interesting patterns in the ordered residuals plot though, so I know they were independently measured.

Although the regression model I created is not appropriate for this situation, there is a real relationship between processor speeds and the prices of the laptops, which might be described with a better model.