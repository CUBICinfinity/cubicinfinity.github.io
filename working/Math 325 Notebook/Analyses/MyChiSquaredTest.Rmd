---
title: "Critique Me"
author: "Jim Greene"
date: "April 2, 2018"
output: 
  html_document:
    theme: simplex
    code_folding: hide
---

```{r, include=F}
library(car)
library(mosaic)
library(ResourceSelection)
library(pander)
library(DT)
library(ggplot2)
library(dplyr)
qs <- read.csv("http://byuimath.com/saunderspractice/ghsaund/qs.csv", header=TRUE)
survey <- read.csv("http://byuimath.com/saunderspractice/ghsaund/survey.csv", header=TRUE)

crit325 <- table(qs$Critiquing, qs$BeingCritiqued)
```

## Background of the Critiques

The MATH 325 Intermediate Statistics class requires students to produce a statistical analysis html document each week. The students then critique each other's analyses prior to resubmission to their professor.

In a survey that students have been required to take each semester, they are asked how helpful various aspects of the course have been to them. They rate the activities on a scale from 0.5 to 3, with 0.5 meaning that it makes them dumber and 3 meaning that it's great. Two of the topics are critiquing other students and being critiqued. We want to know what students are saying about the critiques.

## Analysis to Critique

These barplots show the frequencies of the students' choices:
```{r}
barplot(table(qs$Critiquing), main="Survey Results from MATH 325 Students", xlab="How much they said they like critiquing", ylim=c(0,96), ylab="Number of Students")
```

```{r}
barplot(table(qs$Critiquing), main="Survey Results from MATH 325 Students", xlab="How much they said they like being critiqued", ylim=c(0,96), col="#444444", ylab="Number of Students")
par(new = T)
barplot(table(qs$BeingCritiqued), ylim=c(0,96), density=70)
legend(.7, 80legend=c("Critiquing (background bars)", "Being critiqued (foreground bars)"), col=c("#222222", "#999999"), lty=1:2, cex=0.8)
```

This barplot shows how the responses relate to each other:
```{r}
barplot(crit325, beside=TRUE, ylim=c(0,53), xlab="How much they said they like being critiqued", legend=TRUE, args.legend = list(x="topleft", bty='n', title="How much they said they like critiquing"), main="Survey Results from MATH 325 Students", ylab="Number of Students")
```

A chi-squared test will help us to quantify the relationship.

$$
H_0: \text{How much students like critiquing is independent of how much they like being critiqued.}
$$

$$
H_a: \text{How much students like critiquing is associated with how much they like being critiqued.}
$$

$$
  \chi^2 = \sum_{i=1}^m \frac{(O_i - E_i)^2}{E_i}
$$

</br>Here is a table. The rows here represent how much they like critiquing and the columns are how much they like being critiqued:
```{r}
pander(crit325)
```
</br>

Unfortunately, there are not enough expected counts for some of the caregories:</br>

**Expeccted counts**
```{r}
chi.qs <- chisq.test(crit325, simulate.p.value = TRUE)
pander(chi.qs$expected)
```

</br>
**Expected counts greater than or equal to 1**
```{r}
pander(chi.qs$expected >= 1)
```

</br>
This can be helped by combining the 0.5 and 1 responses into one group:

**Expected counts greater than or equal to 1 after combining 0.5 with 1**
```{r}
qs1 <- qs
qs1$Critiquing <- plyr::mapvalues(qs1$Critiquing, 0.5, 1)
qs1$BeingCritiqued <- plyr::mapvalues(qs1$BeingCritiqued, 0.5, 1)
crit325 <- table(qs1$Critiquing, qs1$BeingCritiqued)
chi.qs1 <- chisq.test(crit325, simulate.p.value = TRUE)
pander(chi.qs1$expected >= 1)
```
[1,1] is still below 1, but the average is above 5 (`r mean(chi.qs1$expected)`) and  for now we'll let it be.

```{r}
barplot(crit325, beside=TRUE, ylim=c(0,53), xlab="How much they said they like being critiqued", legend=TRUE, args.legend = list(x="topleft", bty='n', title="How much they said they like critiquing"), main="Survey Results from MATH 325 Students")
```


```{r}
pander(chi.qs1)
pander(chi.qs1$residuals)
```

## Interpretation

The p-value is strong enough to assume that the two responses are not independent. From reading the chart of residuals, the four most extreme Pearson residuals are [1,1], [3,3], [1.5,1.5], and [1,3] (Formatted [like critiquing, like being critiqued]). In these cases, the amount students said they like critiquing seems to match the amount they said they like being critiqued. However, the requirements were not fully met, so this observation might not be accurate.
```{r, eval=F}
barplot(chi.qs1$residuals, beside=TRUE)
```

