---
title: "Simple Logistic Regression"
output:
  html_document:
    theme: lumen
    highlight: zenburn
    code_folding: hide
---
<center>
```{r, include=FALSE}
library(car)
library(mosaic)
library(DT)
library(pander)
library(ResourceSelection)
library(readr)

un1 <- read_csv("C:/Users/Jim/Desktop/MATH 325/Math 325 Notebook/Data/UN_format.csv")
```
## Introduction
</center>
<div style="padding-left:50px;padding-right:50px;">
**This data table includes the infant mortality rates and GDP for most countries from 1998. </br>
The infant mortality rate (IMF) is the number of children who die in their first year out of every 1,000 live births.</br>
The GDP indicates the GDP per capita, measured in USD.**

```{r}
datatable(un1, options=list(lengthMenu = c(3,15,45,207)))
```
</br>
**The purpose of this analysis is to determine if the GDP can be used to predict if a country has a high IMF, which will be defined as an IMF or 20 or higher.**
</div></div>

<center>
## Analysis
</center>

<div style="padding-left:50px;padding-right:50px;">
**A logistic regression has been performed here:**
</div></div>

$$
P(Y_i = 1|\, x_i) = \frac{e^{\beta_0 + \beta_1 x_i}}{1+e^{\beta_0 + \beta_1 x_i}} = \pi_i
$$
<div style="padding-left:50px;padding-right:50px;">
**
The coefficients of interest are $\beta_0$ and $\beta_1$.</br>$e^{\beta_0}$ is the probability of the IMF being high if the GDP was 0.</br>
$e^{\beta_1}$ is the factor by which the probability changes with each one dollar increase in GDP.
**
</br></br>
**
A P-value of 0.05 or less will be considered significant for the $\beta_0$ and $\beta_1$ values.
**
</div></div>

$$
H_0 : \beta_0 = 0
$$
$$
H_0 : \beta_1 = 0
$$

$$
H_a : \beta_0 \ne 0
$$

$$
H_a : \beta_1 \ne 0
$$
<div style="padding-left:50px;padding-right:50px;">
**
In the summary table below, "(Intercept), Estimate" is the value $\beta_0$ and "GDP, Estimate" is the $\beta_1$ value:
**
</div></div>
<center>
```{r, warning=F}
un.glm <- glm(Infant_Mortality_Rate > 19 ~ GDP, data=un1, family=binomial)
pander(summary(un.glm))
```
</center>
<div style="padding-left:50px;padding-right:50px;">
</br>
**A Hosmer-Lemeshow Goodness of Fit Test shows that this regresion model is appropriate:**
</div></div>
<center>
```{r, warning=F}
pander(hoslem.test(un.glm$y, un.glm$fitted, g=6))
```
</center>
<div style="padding-left:50px;padding-right:50px;">
</br>
**This graph shows the observed relationship:**
</div></div>
<center>
```{r, eval=T, warning=F}
plot(Infant_Mortality_Rate > 19 ~ GDP, data=un1, ylab="Probability of IMR being above 2%", main="High Infant Mortality Rates by Country with Respect to GDP", xlab="GDP per Capita", cex=1.6, lwd=2, col="#111111")
curve(exp(2.0713127-0.0003477*x)/(1+exp(2.0713127-0.0003477*x)), col="#700077", lwd=2, add=TRUE)
```



## Interpretation
</center>
<div style="padding-left:50px;padding-right:50px;">
**
It can be concluded that countries with a lower GDP are more likely to have an infant mortality rate above 2%. This table shows the some specific levels:
**
</div></div>
<center>
<div style="padding-left:295px;padding-right:180px;">
|GDP     |Probability |
|---|---|
|0     |89% |
|968   |85% |
|1,970 |80% |
|2,798 |75% |
|**5,957** |**50%** |
|9,117 |25% |
|12,276  |10% |
|14,426  |5%  |
|19,173 |1% |
</div></div>
</center>
