
---
title: "Simple Linear Regression"
output: 
  html_document:
    theme: journal
    code_folding: hide
---
<script type="text/javascript">
 function showhide(id) {
    var e = document.getElementById(id);
    e.style.display = (e.style.display == 'block') ? 'none' : 'block';
 }
</script>
```{r, include=F}
library(mosaic)
library(DT)
library(pander)
library(plyr)
library(car)
library(readr)
library(Hmisc)
```

```{r}
credit <- read.csv("C:/Users/Jim/Desktop/MATH 325/Math 325 Notebook/Data/credit.csv")
```

<!-- Directions

Come up with a simple linear regression of your own creation. 

* Write the Background and clearly state your question. Then collect data and perform the linear regression analysis in order to answer your question. Use the proper order of first, ask the question, then second, figure out the answer.

* You should collect both the quantitative response variable and the quantitative explanatory variable yourself. This can be data you collect from 
    - the internet (like weather data, Facebook data, or sports data) 
    - your own experiment 
    - your own observational study
* However,     
    - The data should not be a single pre-existing dataset. It must be something that you piece together yourself.

* You need at least $n=3$ $(X,Y)$ pairs to perform the regression. However, your regression will only be useful if you can get around $n=10$ or more observations.



-->
<a href="javascript:showhide('1')">Click to read the prologue</a>
<div id="1" style="display:none;">
It was a dark and cold night. My girlfriend had abandoned me (not permanently). I went to my friend's place where he let me sleep. I looked at the homework before me: Make a simple linear model from data I piece together on my own. I had a few ideas. I could compare height with the pitch of one's voice. But that would be too difficult to measure. Then it came to me. Let me study the relationship between a student's credit load and their GPA.

This analysis is dedicated to my dog, Rocky
</div>

## Background
Does the number of credits a student takes in a single semester impact their GPA?</br></br>
My theory is that even though more credits makes it harder to get good grades, the students who take more credits will have a higher GPA because they are more serious about their studies. I will see.</br></br>
I surveyed 15 single male students from two neighboring apartments: Quincy House A and Quincy House B. They were asked these two questions:</br></br>
***The last semester/term in which you took at least one course, how many credits did you take?</br>
What was you GPA for those credits?***</br></br>
This is the result:
```{r}
pander(credit)
```
The students are labeled in the order they were surveyed.</br>
Students 6 and 14 did not provide a GPA.</br>
Student 15 provided an estimated average.</br>
There is a 10th resident of apartment A, whom I did not meet.</br>
I will be using the 13 complete measurements.

## Analysis 

I am using linear regression in attempt to describe the relationship.
$$Y_i = \beta_0 + \beta_1 X_i + \epsilon_i$$
<center>
In the above equation:</br>
$Y_i$ is the GPA.</br>
$X_i$ is the number of credits.</br>
$\beta_1$ is the slope of the regression relation.</br>
$\beta_0$ is the Y-intercept, the base height of the line.</br>
$\epsilon_i$ is the error term, the distance $Y_i$ falls from the line.
</br>

Hypothesis statement:</center>
$$
H_0:β_1=0
$$
$$
H_a:β_1≠0
$$
I will use a confidence level of 0.90 ($\alpha=0.1$). </br></br>
I want to look at the plot first:
```{r}
plot(gpa ~ credit, data=credit, pch=16, col="#D00000", xlab="Number of Credits", ylab="GPA", main="Single Male Students at BYU-Idaho")
minor.tick(nx=5, tick.ratio=1)
credit.lm <- lm(gpa ~ credit, data=credit)
abline(credit.lm)
#pander(credit.lm)
```
With only 13 points, I need to know that the residuals follow a normal distribution to make use of the model.

```{r}
par(mfrow=c(1,2))
plot(credit.lm, which=2:1)
```

The residuals are not normal, and the variance is not constant either.</br>This seems to be mostly due to the outlier, so I'll see what it is like without it:
```{r}
par(mfrow=c(1,2))
credit12 <- subset(credit, student!="1")
credit12.lm <- lm(gpa ~ credit, data=credit12)
plot(credit12.lm, which=2:1)
```
</br>The variance appears constant now, but the residuals still are not normal enough. Also, the observations do not seem independent.</br>
This is the linear model without the outlier:
```{r}
plot(gpa ~ credit, data=credit12, pch=16, col="#D00000", xlab="Number of Credits", ylab="GPA", main="Single Male Students at BYU-Idaho")
minor.tick(nx=5, tick.ratio=1)
abline(credit12.lm)
```
<br/>Below is the statistical summary for the linear model without the outlier. The "credit" row of the table gives the details of $\beta_1$ (the slope).
```{r}
pander(credit12.lm)
```

Note that the last column shows the P-value is at 0.34.

## Interpretation

There could be a very small positive relationship, matching my original guess. However, the P-value for the slope is rather insignificant and the requirements were not closely met for this test. For this reason, I cannot reject the null hypothesis that the number of credits a student takes in a semester and their GPA are independent.

I've run out of cake.