---
title: "Untitled"
author: "Jim Greene"
date: "April 6, 2018"
output: pdf_document
---

```{r, eval=FALSE}

# Create the data:
set.seed(1140411)
sample1 <- rnorm(30, 69, 2.5)
sample2 <- rnorm(30, 69, 2.5)
theData <- data.frame(values = c(sample1,sample2), group = rep(c(1,2), each=30))
View(theData)
boxplot(values ~ group, data = theData)
```
 
```{r}
# Run the permutation test:

myTest <-  t.test(values ~ group, data=theData, mu=0)
observedTestStat <- myTest$statistic

N <- 2000      
permutedTestStats <-  rep(NA, N)
for  (i in 1:N ) {
   permutedData <- sample(x=theData$group)
   permutedTest <- t.test(values ~ permutedData, data=theData, mu=0)
   permutedTestStats[i]  <-  permutedTest$statistic
}
hist(permutedTestStats)
abline(v=observedTestStat)
```


```{r}
observedTestStat
sum(permutedTestStats >= observedTestStat)/N
sum(permutedTestStats <= observedTestStat)/N
sum(permutedTestStats <= observedTestStat)/N * 2
```