---
title: "Volusia and Flagler County Murders, 2007-2017"
author: "Jim Greene"
date: "March 15, 2018"
output: html_document
---

```{r setup, include=FALSE}
library(car)
library(mosaic)
library(pander)
library(DT)
library(ggplot2)
library(ggmap)
library(qmap)
library(readr)
library(lubridate)
knitr::opts_chunk$set
data <- read_csv("C:/Users/Jim/Desktop/MATH 325/Math 325 Notebook/Data/murder.csv")
```

# {.tabset .tabset-fade}

## Data
```{r, echo=F}
ordered <- data[, c(1,2,3,4,8,16,5,6,7,9,10,11,12,13,14,15,17,18,19,20,21,22,23,24,25,26,27,28)]
datatable(ordered, extensions="Responsive", options=list(lengthMenu = c(10,30,100,204)))
```


## Time Series
```{r, echo=F, include=T}
data$month <- month.abb[as.factor(month(as.POSIXlt(data$Murder_date_or_date_body_found, format="%m/%d/%y")))]

data$month_num <- as.numeric(month(as.POSIXlt(data$Murder_date_or_date_body_found, format="%m/%d/%y")))

#barplot(data[c(3,1,2)], main="order example", names.arg=c("3rd column", "1st column", "2nd column"))
#hist(data$month_num, 12, breaks=12)
#stripchart(subset(data, Year="2007")$month_num, method="stack", col="black", pch=16)
#pander(table(data$Year))
#pander(table(data$month)[c(5,4,8,1,9,7,6,2,12,11,10,3)])

ggplot(data[-c(189),], aes(month, fill = as.factor(Year))) + geom_bar(position='dodge', alpha = 1)+ scale_x_discrete(limits = month.abb) + xlab("Month") + ylab("Count") + ggtitle("Volusia and Flagler County Murders 2007-2017") + scale_fill_manual(values=c("coral","indianred","#440055","darkorange","chocolate4","dodgerblue4","#809000","#cc0000","darkgoldenrod2","deeppink2","#00dd00","cyan","darkmagenta","aquamarine3","black"), name = "Year")

barplot(table(data$Year), main="Volusia and Flagler County Murders by Year, 2007-2017")
barplot(table(data$month)[c(5,4,8,1,9,7,6,2,12,11,10,3)], main="Volusia and Flagler County Murders by Month, 2007-2017")#, main="Total count murders by month", xlab="Month")

```


## Geography
```{r, echo=F, warning=F, include=F, eval=T}
region <- c(left = -82, bottom = 28, right = -80, top = 30)

flmap <- ggmap(get_stamenmap(region, zoom = 6, maptype = "toner-lite"))

close <- subset(data, Latitude < 30 & Latitude > 27)

close$Cause_of_death <- plyr::mapvalues(close$Cause_of_death, c("Strangled", "Blunt trauma"), c("Strangling", "Blunt force trauma"))
```

![](C:/Users/Jim/Desktop/MATH 325/Math 325 Notebook/Images/map_heat2.png)

```{r, echo=F, warning=F, eval=F, include=T}
qmplot(Longitude, Latitude, data = close, alpha = 1, color="green", main="Flagler and Volusia County Murders, 2007 - 2017") + stat_density_2d(aes(fill = ..level..), geom = "polygon", alpha = .3, color = NA) + scale_fill_gradient("Density", low = "yellow", high = "red") + guides(alpha=FALSE)
```

</br></br>
![](C:/Users/Jim/Desktop/MATH 325/Math 325 Notebook/Images/map_types.png)

```{r, echo=F, warning=F, eval=F, include=T}
colors <- c("indianred","chocolate4","purple","magenta","dodgerblue4","olivedrab","red","coral","darkgoldenrod2","deeppink1","green","cyan","darkmagenta","aquamarine3","darkorange","black")
qmplot(Longitude, Latitude, data = close, col=Cause_of_death, pch=Cause_of_death, alpha=0.3, legend="none", main="Flagler and Volusia County Murders, 2007 - 2017") + scale_color_manual(values = colors) + scale_shape_manual(values=c(0,1,2,3,4,6,7,8,11,10,12,15,16,17,19,14)) + labs(color='Cause of death', pch='Cause of death')  + guides(alpha=FALSE)
```

## Map Credit

Map from URL : </br>
http://tile.stamen.com/toner-lite/10/278/423.png </br>
http://tile.stamen.com/toner-lite/10/279/423.png </br>
http://tile.stamen.com/toner-lite/10/280/423.png </br>
http://tile.stamen.com/toner-lite/10/281/423.png </br>
http://tile.stamen.com/toner-lite/10/282/423.png </br>
http://tile.stamen.com/toner-lite/10/278/424.png </br>
http://tile.stamen.com/toner-lite/10/279/424.png </br>
http://tile.stamen.com/toner-lite/10/280/424.png </br>
http://tile.stamen.com/toner-lite/10/281/424.png </br>
http://tile.stamen.com/toner-lite/10/282/424.png </br>
http://tile.stamen.com/toner-lite/10/278/425.png </br>
http://tile.stamen.com/toner-lite/10/279/425.png </br>
http://tile.stamen.com/toner-lite/10/280/425.png </br>
http://tile.stamen.com/toner-lite/10/281/425.png </br>
http://tile.stamen.com/toner-lite/10/282/425.png </br>
http://tile.stamen.com/toner-lite/10/278/426.png </br>
http://tile.stamen.com/toner-lite/10/279/426.png </br>
http://tile.stamen.com/toner-lite/10/280/426.png </br>
http://tile.stamen.com/toner-lite/10/281/426.png </br>
http://tile.stamen.com/toner-lite/10/282/426.png

#
